--- a/focusd/dns.py
+++ b/focusd/dns.py
@@ -15,10 +15,16 @@ from typing import List, Set
 class DNSManager:
     """Manages /etc/hosts entries and DNS cache flushing."""

     HOSTS_FILE = Path("/etc/hosts")
+    NIXOS_STATE_DIR = Path("/var/lib/focusd")
+    NIXOS_HOSTS_ADDITIONS = NIXOS_STATE_DIR / "hosts-additions"
+    NIXOS_MERGE_SCRIPT = "/run/current-system/sw/bin/focusd-merge-hosts"
     BEGIN_MARKER = "# BEGIN focusd:{profile}"
     END_MARKER = "# END focusd:{profile}"

     def __init__(self, hosts_path: Path = None):
         self.hosts_path = hosts_path or self.HOSTS_FILE
+        # Check if running on NixOS
+        self.is_nixos = os.environ.get('FOCUSD_NIXOS', '0') == '1' or \
+                        Path('/etc/NIXOS').exists()

     def enable(self, profile_name: str, domains: List[str]):
         """
@@ -30,6 +36,11 @@ class DNSManager:
         # Expand domains to include common variants
         expanded = self._expand_domains(domains)

+        # On NixOS, write to state file and call merge script
+        if self.is_nixos:
+            self._enable_nixos(profile_name, expanded)
+            return
+
         # Read current hosts file
         if self.hosts_path.exists():
             with open(self.hosts_path, 'r') as f:
@@ -61,6 +72,11 @@ class DNSManager:
     def disable(self, profile_name: str):
         """
         Remove the focusd block from /etc/hosts.
         """
+        # On NixOS, update state file and call merge script
+        if self.is_nixos:
+            self._disable_nixos(profile_name)
+            return
+
         if not self.hosts_path.exists():
             return

@@ -77,6 +93,87 @@ class DNSManager:
         # Flush resolver cache
         self._flush_dns_cache()

+    def _enable_nixos(self, profile_name: str, domains: Set[str]):
+        """
+        NixOS-specific enable: write domains to state file and trigger merge.
+        """
+        import logging
+        logger = logging.getLogger(__name__)
+
+        # Ensure state directory exists
+        self.NIXOS_STATE_DIR.mkdir(parents=True, exist_ok=True)
+
+        # Read existing additions file
+        if self.NIXOS_HOSTS_ADDITIONS.exists():
+            with open(self.NIXOS_HOSTS_ADDITIONS, 'r') as f:
+                lines = f.readlines()
+        else:
+            lines = []
+
+        # Remove existing block for this profile
+        cleaned = self._remove_block(lines, profile_name)
+
+        # Add new block
+        begin = self.BEGIN_MARKER.format(profile=profile_name)
+        end = self.END_MARKER.format(profile=profile_name)
+
+        new_block = [f"{begin}\n"]
+        for domain in sorted(domains):
+            new_block.append(f"0.0.0.0 {domain}\n")
+        new_block.append(f"{end}\n")
+
+        # Combine and write
+        new_lines = cleaned + new_block
+
+        with open(self.NIXOS_HOSTS_ADDITIONS, 'w') as f:
+            f.writelines(new_lines)
+
+        # Call NixOS merge script to rebuild /etc/hosts
+        try:
+            result = subprocess.run(
+                [str(self.NIXOS_MERGE_SCRIPT)],
+                capture_output=True,
+                timeout=10,
+                text=True
+            )
+            if result.returncode != 0:
+                logger.error(f"Failed to merge hosts: {result.stderr}")
+                raise Exception(f"NixOS hosts merge failed: {result.stderr}")
+            logger.info("Successfully merged hosts on NixOS")
+        except FileNotFoundError:
+            logger.error(f"NixOS merge script not found at {self.NIXOS_MERGE_SCRIPT}")
+            raise
+
+        # Flush DNS cache
+        self._flush_dns_cache()
+
+    def _disable_nixos(self, profile_name: str):
+        """
+        NixOS-specific disable: remove profile from state file and trigger merge.
+        """
+        import logging
+        logger = logging.getLogger(__name__)
+
+        if not self.NIXOS_HOSTS_ADDITIONS.exists():
+            return
+
+        # Read and clean
+        with open(self.NIXOS_HOSTS_ADDITIONS, 'r') as f:
+            lines = f.readlines()
+
+        cleaned = self._remove_block(lines, profile_name)
+
+        with open(self.NIXOS_HOSTS_ADDITIONS, 'w') as f:
+            f.writelines(cleaned)
+
+        # Call merge script
+        try:
+            subprocess.run([str(self.NIXOS_MERGE_SCRIPT)], check=True, timeout=10)
+            logger.info("Successfully merged hosts on NixOS")
+        except Exception as e:
+            logger.error(f"Failed to merge hosts: {e}")
+
+        self._flush_dns_cache()
+
     def _expand_domains(self, domains: List[str]) -> Set[str]:
         """
         Expand domains to include common variants.
